{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u0000 \u0000W\u0000e\u0000l\u0000c\u0000o\u0000m\u0000e\u0000 \u0000t\u0000o\u0000 \u0000a\u0000u\u0000X\u0000p\u0000l\u0000o\u0000i\u0000t\u0000 \u0000W\u0000r\u0000i\u0000t\u0000e\u0000s\u0000","text":"<p>\u0000 \u0000</p>"},{"location":"ctf/","title":"CTF Writeups","text":"<p>Documentation of Capture The Flag challenges and penetration testing methodology.</p>"},{"location":"ctf/#recent-events","title":"Recent Events","text":"<p>Coming Soon....................</p>"},{"location":"homelab/","title":"Homelab Projects","text":"<p>Welcome to my homelab documentation. Here I document infrastructure experiments, security implementations, and lessons learned from building a production-like home environment.</p>"},{"location":"homelab/#current-projects","title":"Current Projects","text":""},{"location":"homelab/#wireguard-vpn-on-proxmox-lxc","title":"WireGuard VPN on Proxmox (LXC)","text":"<p>Detailed troubleshooting of running WireGuard in Proxmox LXC containers, including packet-level analysis with tcpdump and architectural decision-making and it's failure</p> <p>Status: LXC experiment complete \u2192 VM migration planned Skills: <code>WireGuard</code> <code>Proxmox</code> <code>Linux Networking</code> <code>tcpdump</code> <code>iptables</code> <code>NAT</code></p>"},{"location":"homelab/#coming-soon","title":"Coming Soon","text":"<ul> <li>WireGuard VM Migration - Moving VPN server to dedicated Opensense</li> <li>pfSense Edge Firewall - Enterprise firewall with VLANs and IDS/IPS</li> </ul>"},{"location":"homelab/#lab-environment","title":"Lab Environment","text":"<p>Current Setup: - Proxmox Host: 192.168.1.10 - LAN: 192.168.1.0/24 - WireGuard Subnet: 10.8.0.0/24</p> <p>Planned Upgrades: - Intel i350-T4 quad-port NIC - Opensense</p>"},{"location":"homelab/#learning-objectives","title":"Learning Objectives","text":"<ul> <li> Proxmox LXC vs VM trade-offs</li> <li> WireGuard protocol and configuration</li> <li> Linux packet routing and NAT</li> <li> Network troubleshooting with tcpdump</li> <li> pfSense advanced routing</li> <li> Infrastructure as Code (Ansible)</li> </ul>"},{"location":"homelab/network/wireguard-proxmox-lxc/","title":"\ud83d\udd10 WireGuard VPN Setup on Debian Container (LXC Attempt)","text":"<p>Portfolio documentation: objective, architecture, configs, troubleshooting, root-cause, and final decision to move WG server from LXC \u2192 Debian VM.</p>"},{"location":"homelab/network/wireguard-proxmox-lxc/#objective","title":"Objective","text":"<ul> <li>Secure remote access to my homelab using WireGuard.</li> </ul>"},{"location":"homelab/network/wireguard-proxmox-lxc/#environment","title":"Environment","text":"<ul> <li>Proxmox Host (static): 192.168.1.10</li> <li>Debian VPN server (LXC, attempt 1): 192.168.1.20</li> <li>Router/Gateway: 192.168.1.1</li> <li>LAN: 192.168.1.0/24</li> <li>WireGuard subnet: 10.8.0.0/24</li> <li>Port forward: UDP 51820 \u2192 192.168.1.20</li> <li>Public IPv4 present; PVE firewall disabled for tests.</li> </ul>"},{"location":"homelab/network/wireguard-proxmox-lxc/#architecture-proxmox-lxc-wireguard-setup","title":"\ud83c\udfd7 Architecture \u2013 Proxmox LXC WireGuard Setup","text":"<p>Here is the network flow for my initial WireGuard setup using a Debian LXC on Proxmox:</p> <p></p>"},{"location":"homelab/network/wireguard-proxmox-lxc/#key-configs-lxc-attempt","title":"Key Configs (LXC Attempt)","text":"<p>Server /etc/wireguard/wg0.conf (minimal, IPv4):</p> <p>[Interface] Address    = 10.8.0.1/24 ListenPort = 51820 PrivateKey =  PostUp   = iptables -t nat -A POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE PostDown = iptables -t nat -D POSTROUTING -s 10.8.0.0/24 -o eth0 -j MASQUERADE <p>[Peer]  # au-phone PublicKey =  AllowedIPs = 10.8.0.2/32 PersistentKeepalive = 25 <p>[Peer]  # au-worklaptop PublicKey =  AllowedIPs = 10.8.0.3/32 PersistentKeepalive = 25"},{"location":"homelab/network/wireguard-proxmox-lxc/#client-template-androidlaptop","title":"Client template (Android/Laptop):","text":"<p>[Interface] PrivateKey =  Address = 10.8.0.2/32 DNS = 1.1.1.1 <p>[Peer] PublicKey =  Endpoint = :51820 AllowedIPs = 0.0.0.0/0, ::/0 PersistentKeepalive = 25"},{"location":"homelab/network/wireguard-proxmox-lxc/#troubleshooting-highlights","title":"Troubleshooting Highlights","text":"<p>Verified: ss -lunp | grep 51820 (WG listening), sysctl net.ipv4.ip_forward=1, MASQUERADE present, router port forward correct, public IPv4 present, PVE firewall disabled.</p> <p>tcpdump path checks:</p> <p>Host vmbr0: check UDP/51820 arrives from WAN.</p> <p>Host veth104i0: check forwarding into the CT.</p> <p>Inside LXC eth0: check packets inside CT.</p> <p>Outcome: no reliable handshake at the CT boundary \u2192 containerization/kernel/capability constraints, not WG config.</p>"},{"location":"homelab/network/wireguard-proxmox-lxc/#root-cause","title":"Root Cause","text":"<p>Running a WG server inside LXC adds kernel/capability hurdles (module loading, /dev/net/tun, CAP_NET_ADMIN, AppArmor/cgroup constraints, bridge/veth path). Result: handshakes fail despite correct configs.</p>"},{"location":"homelab/network/wireguard-proxmox-lxc/#decision","title":"Decision","text":"<p>Migrate WG server to a Debian VM on Proxmox (full kernel control, simpler routing/NAT, production-like).</p> <p>Status: Failed Approach - Moving to OPNsense </p>"},{"location":"homelab/network/wireguard-proxmox-vm/","title":"\ud83d\udd10 WireGuard VPN Setup on Debian VM","text":"<p>A documentation of my attempt to set up WireGuard VPN on a Debian VM, the challenges I encountered, and why I'm moving to an OPNsense-based solution.</p>"},{"location":"homelab/network/wireguard-proxmox-vm/#overview","title":"Overview","text":"<p>Goal: Set up a WireGuard VPN to securely access my home network from anywhere.</p> <p>Environment: - Proxmox Host (static): 192.168.1.10 - Debian VPN server (LXC, attempt 1): 192.168.1.171 - Home network with dynamic IPv6 - Mobile and laptop clients</p> <p>Outcome: Approach failed due to ISP router limitations. Switching to OPNsense firewall solution.</p>"},{"location":"homelab/network/wireguard-proxmox-vm/#system-architecture-attempted","title":"System Architecture (Attempted)","text":"<pre><code>Internet\n   \u2502\n   \u2514\u2500 ISP Router (192.168.1.1)\n        \u251c\u2500 Proxmox Host\n        \u2502    \u2514\u2500 Debian VM (192.168.1.171)\n        \u2502         \u2514\u2500 WireGuard Server (port 51820)\n        \u2502\n        \u2514\u2500 Clients (mobile, laptop)\n</code></pre>"},{"location":"homelab/network/wireguard-proxmox-vm/#setup-process","title":"Setup Process","text":""},{"location":"homelab/network/wireguard-proxmox-vm/#1-install-wireguard","title":"1. Install WireGuard","text":"<p>On the Debian VM:</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\nsudo apt install wireguard wireguard-tools curl -y\n</code></pre>"},{"location":"homelab/network/wireguard-proxmox-vm/#2-enable-ip-forwarding","title":"2. Enable IP Forwarding","text":"<p>Create <code>/etc/sysctl.d/99-sysctl.conf</code> and add:</p> <pre><code>net.ipv4.ip_forward=1\n</code></pre> <p>Apply with: <pre><code>sudo sysctl --system\n</code></pre></p>"},{"location":"homelab/network/wireguard-proxmox-vm/#3-generate-keys","title":"3. Generate Keys","text":"<p>For the server and each client:</p> <pre><code>cd /etc/wireguard\nsudo umask 077\n\n# Server keys\nsudo wg genkey | sudo tee server_private.key | wg pubkey | sudo tee server_public.key\n\n# Mobile client keys\nsudo wg genkey | sudo tee mobile_private.key | wg pubkey | sudo tee mobile_public.key\n</code></pre>"},{"location":"homelab/network/wireguard-proxmox-vm/#4-configure-the-server","title":"4. Configure the Server","text":"<p>Create <code>/etc/wireguard/wg0.conf</code>:</p> <pre><code>[Interface]\nPrivateKey = &lt;SERVER_PRIVATE_KEY&gt;\nAddress = 10.8.0.1/24\nListenPort = 51820\n\n# NAT rules - replace ens18 with your interface name\nPostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o ens18 -j MASQUERADE\nPostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o ens18 -j MASQUERADE\n\n[Peer]    # Mobile Client\nPublicKey = &lt;MOBILE_PUBLIC_KEY&gt;\nAllowedIPs = 10.8.0.2/32\nPersistentKeepalive = 25\n</code></pre> <p>Start WireGuard: <pre><code>sudo systemctl enable wg-quick@wg0\nsudo systemctl start wg-quick@wg0\n</code></pre></p>"},{"location":"homelab/network/wireguard-proxmox-vm/#5-configure-firewall","title":"5. Configure Firewall","text":"<p>Set up UFW to allow WireGuard:</p> <pre><code>sudo ufw allow 22/tcp      # SSH\nsudo ufw allow 51820/udp   # WireGuard\nsudo ufw enable\n</code></pre>"},{"location":"homelab/network/wireguard-proxmox-vm/#6-configure-clients","title":"6. Configure Clients","text":"<p>Mobile (Android):</p> <p>Create a config file:</p> <pre><code>[Interface]\nPrivateKey = &lt;MOBILE_PRIVATE_KEY&gt;\nAddress = 10.8.0.2/32\nDNS = 1.1.1.1\n\n[Peer]\nPublicKey = &lt;SERVER_PUBLIC_KEY&gt;\nEndpoint = &lt;YOUR_IPV6_OR_DOMAIN&gt;:51820\nAllowedIPs = 0.0.0.0/0\nPersistentKeepalive = 25\n</code></pre> <p>Import into the WireGuard app (via QR code or manual entry).</p>"},{"location":"homelab/network/wireguard-proxmox-vm/#the-challenges-i-faced","title":"The Challenges I Faced","text":""},{"location":"homelab/network/wireguard-proxmox-vm/#challenge-1-router-firewall-blocking-vpn","title":"Challenge 1: Router Firewall Blocking VPN","text":"<p>The Problem: My router's firewall is set to \"High\" security mode, blocking all incoming VPN connections. While I can disable the firewall, I choose not to due to serious security implications (explained below).</p> <p>What I Tried:</p> <ol> <li>Port Forwarding Configuration</li> <li>Correctly set up UDP 51820 \u2192 192.168.1.171</li> <li> <p>Verified multiple times, rebooted router</p> </li> <li> <p>Firewall Security Levels</p> </li> <li>Tried Medium and Low security settings</li> <li> <p>Still blocked incoming VPN traffic</p> </li> <li> <p>Tested with Firewall Disabled</p> </li> <li>Temporarily disabled firewall to test</li> <li>VPN worked perfectly during this time</li> </ol>"},{"location":"homelab/network/wireguard-proxmox-vm/#challenge-2-ipv6-duckdns-approach","title":"Challenge 2: IPv6 + DuckDNS Approach","text":"<p>The Attempt: I noticed that my ISP is providing IPV6 address (public) and this gets updated after a certain period of time, hence I tried using IPv6 with DuckDNS for dynamic DNS.</p> <p>Here I learnt the concept of CGNAT and why does ISPs use this.</p> <p>Brief Info (Please skip if you already knew this) What is CGNAT? Carrier-Grade NAT is a technique ISPs use when they run out of public IPv4 addresses. Instead of giving each customer a unique public IP, they share one public IP among many customers. Why ISPs Use It: - IPv4 address exhaustion (not enough IPs for everyone)</p> <p>DuckDNS Setup:</p> <p>DuckDNS is a free service that gives you a permanent domain name that automatically updates to point to your current IP.</p> <p>Setup on server:</p> <pre><code>mkdir ~/duckdns\ncd ~/duckdns\nnano duck.sh\n</code></pre> <p>Script content: <pre><code>#!/bin/bash\nIPV6=$(curl -6 -s ifconfig.me)\necho url=\"https://www.duckdns.org/update?domains=YOUR-SUBDOMAIN&amp;token=YOUR-TOKEN&amp;ipv6=$IPV6&amp;clear=true\" | curl -k -o ~/duckdns/duck.log -K -\n</code></pre></p> <p>Important: The <code>&amp;clear=true</code> parameter removes the IPv4 address from DNS, forcing clients to use IPv6 only.</p> <p>Set to auto-update every 5 minutes: <pre><code>chmod +x duck.sh\ncrontab -e\n</code></pre></p> <p>Add: <pre><code>*/5 * * * * ~/duckdns/duck.sh &gt;/dev/null 2&gt;&amp;1\n</code></pre></p> <p>Cron Syntax Explained: - <code>*/5</code> = Every 5 minutes - <code>* * * *</code> = Every hour, day, month, and day of week - <code>&gt;/dev/null 2&gt;&amp;1</code> = Discard output to avoid email spam</p> <p>Why This Failed:</p> <p>Despite having IPv6 and DuckDNS configured: - VPN worked when firewall was disabled (testing only) - With firewall re-enabled at any security level, all connections blocked - The router's firewall blocks incoming traffic regardless of IPv4 or IPv6 - DuckDNS correctly updated addresses, but traffic never reached my server</p> <p>Lesson Learned: IPv6 bypasses NAT/port forwarding complexity, but it doesn't bypass firewall rules. Whether using IPv4 or IPv6, if the firewall blocks incoming connections on port 51820, the VPN won't work.</p> <p>The Core Problem: While I could disable the router's firewall to make VPN work, I'm unwilling to compromise security. I need a solution that provides both VPN access and proper network protection.</p>"},{"location":"homelab/network/wireguard-proxmox-vm/#the-solution-moving-to-opnsense","title":"The Solution: Moving to OPNsense","text":""},{"location":"homelab/network/wireguard-proxmox-vm/#why-opnsense","title":"Why OPNsense?","text":"<p>Since I choose not to disable the router's firewall for security reasons, I need to place my own firewall/router in front of my network that I have full control over - one that can properly allow VPN traffic while maintaining security.</p>"},{"location":"homelab/network/wireguard-proxmox-vm/#conclusion","title":"Conclusion","text":"<p>While the WireGuard setup on Debian VM was technically sound, the router's firewall blocking incoming connections made it unviable without disabling security features. Since I'm unwilling to compromise network security by disabling the firewall, I need a better architectural solution.</p> <p>This experience taught me valuable lessons about network architecture, ISP limitations, and the importance of proper infrastructure. The time spent troubleshooting wasn't wasted - understanding why this approach failed will inform better decisions in the OPNsense implementation.</p> <p>Status: Failed Approach - Moving to OPNsense  </p>"}]}